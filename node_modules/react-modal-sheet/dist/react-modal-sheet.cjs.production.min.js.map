{"version":3,"file":"react-modal-sheet.cjs.production.min.js","sources":["../src/constants.ts","../src/utils.ts","../src/hooks.tsx","../src/context.tsx","../src/use-prevent-scroll.ts","../src/styles.ts","../src/sheet.tsx","../src/SheetContainer.tsx","../src/SheetContent.tsx","../src/SheetHeader.tsx","../src/SheetBackdrop.tsx","../src/SheetScroller.tsx","../src/index.tsx"],"sourcesContent":["export const MAX_HEIGHT = 'calc(100% - env(safe-area-inset-top) - 34px)';\n\nexport const IS_SSR = typeof window === 'undefined';\n\nexport const DEFAULT_TWEEN_CONFIG = {\n  ease: 'easeOut',\n  duration: 0.2,\n};\n\nexport const REDUCED_MOTION_TWEEN_CONFIG = {\n  ease: 'linear',\n  duration: 0.01,\n};\n\nexport const DRAG_CLOSE_THRESHOLD = 0.6;\n\nexport const DRAG_VELOCITY_THRESHOLD = 500;\n","import * as React from 'react';\n\nexport function getClosest(nums: number[], goal: number) {\n  let closest = nums[0];\n  let minDifference = Math.abs(nums[0] - goal);\n\n  for (let i = 1; i < nums.length; i++) {\n    const difference = Math.abs(nums[i] - goal);\n    if (difference < minDifference) {\n      closest = nums[i];\n      minDifference = difference;\n    }\n  }\n\n  return closest;\n}\n\nexport function applyRootStyles(rootId: string) {\n  const body = document.querySelector('body') as HTMLBodyElement;\n  const root = document.querySelector(`#${rootId}`) as HTMLDivElement;\n\n  if (root) {\n    const p = 24;\n    const h = window.innerHeight;\n    const s = (h - p) / h;\n    body.style.backgroundColor = '#000';\n    root.style.overflow = 'hidden';\n    root.style.willChange = 'transform';\n    root.style.transition =\n      'transform 200ms ease-in-out, border-radius 200ms linear';\n    root.style.transform = `translateY(calc(env(safe-area-inset-top) + ${p / 2}px)) scale(${s})`; // prettier-ignore\n    root.style.borderTopRightRadius = '10px';\n    root.style.borderTopLeftRadius = '10px';\n  }\n}\n\nexport function cleanupRootStyles(rootId: string) {\n  const body = document.querySelector('body') as HTMLBodyElement;\n  const root = document.getElementById(rootId) as HTMLDivElement;\n\n  function onTransitionEnd() {\n    root.style.removeProperty('overflow');\n    root.style.removeProperty('will-change');\n    root.style.removeProperty('transition');\n    body.style.removeProperty('background-color');\n    root.removeEventListener('transitionend', onTransitionEnd);\n  }\n\n  if (root) {\n    // Start animating back\n    root.style.removeProperty('border-top-right-radius');\n    root.style.removeProperty('border-top-left-radius');\n    root.style.removeProperty('transform');\n\n    // Remove temp properties after animation is finished\n    root.addEventListener('transitionend', onTransitionEnd);\n  }\n}\n\nexport function inDescendingOrder(arr: number[]) {\n  for (let i = 0; i < arr.length; i++) {\n    if (arr[i + 1] > arr[i]) return false;\n  }\n\n  return true;\n}\n\nexport function validateSnapTo({\n  snapTo,\n  sheetHeight,\n}: {\n  snapTo: number;\n  sheetHeight: number;\n}) {\n  if (snapTo < 0) {\n    console.warn(\n      `Snap point is out of bounds. Sheet height is ${sheetHeight} but snap point is ${sheetHeight +\n        Math.abs(snapTo)}.`\n    );\n  }\n\n  return Math.max(Math.round(snapTo), 0);\n}\n\nexport function mergeRefs<T = any>(\n  refs: React.ForwardedRef<T>[]\n): React.RefCallback<T> {\n  return (value: any) => {\n    refs.forEach((ref: any) => {\n      if (typeof ref === 'function') {\n        ref(value);\n      } else if (ref) {\n        ref.current = value;\n      }\n    });\n  };\n}\n\nexport function isTouchDevice() {\n  if (typeof window === 'undefined') return false;\n  return 'ontouchstart' in window || navigator.maxTouchPoints > 0;\n}\n","import * as React from 'react';\n\nimport { IS_SSR } from './constants';\nimport { SheetEvents } from './types';\nimport { applyRootStyles, cleanupRootStyles } from './utils';\nimport { BoundingBox } from 'framer-motion';\n\nexport const useIsomorphicLayoutEffect = IS_SSR\n  ? React.useEffect\n  : React.useLayoutEffect;\n\nexport function useModalEffect(isOpen: boolean, rootId?: string) {\n  const prevOpen = usePrevious(isOpen);\n\n  // Automatically apply the iOS modal effect to the body when sheet opens/closes\n  React.useEffect(() => {\n    if (rootId && !prevOpen && isOpen) {\n      applyRootStyles(rootId);\n    } else if (rootId && !isOpen && prevOpen) {\n      cleanupRootStyles(rootId);\n    }\n  }, [isOpen, prevOpen]); // eslint-disable-line\n\n  // Make sure to cleanup modal styles on unmount\n  React.useEffect(() => {\n    return () => {\n      if (rootId && isOpen) cleanupRootStyles(rootId);\n    };\n  }, [isOpen]); // eslint-disable-line\n}\n\nexport function useEventCallbacks(\n  isOpen: boolean,\n  callbacks: React.MutableRefObject<SheetEvents>\n) {\n  const prevOpen = usePrevious(isOpen);\n  const didOpen = React.useRef(false);\n\n  // Because of AnimatePrecence we don't have access to latest isOpen value\n  // so we need to read and write to a ref to determine if we are\n  // opening or closing the sheet\n  const handleAnimationComplete = React.useCallback(() => {\n    if (!didOpen.current) {\n      callbacks.current.onOpenEnd?.();\n      didOpen.current = true;\n    } else {\n      callbacks.current.onCloseEnd?.();\n      didOpen.current = false;\n    }\n  }, [isOpen, prevOpen]); // eslint-disable-line\n\n  React.useEffect(() => {\n    if (!prevOpen && isOpen) {\n      callbacks.current.onOpenStart?.();\n    } else if (!isOpen && prevOpen) {\n      callbacks.current.onCloseStart?.();\n    }\n  }, [isOpen, prevOpen]); // eslint-disable-line\n\n  return { handleAnimationComplete };\n}\n\nexport function useWindowHeight() {\n  const [windowHeight, setWindowHeight] = React.useState(0);\n\n  useIsomorphicLayoutEffect(() => {\n    const updateHeight = () => setWindowHeight(window.innerHeight);\n    window.addEventListener('resize', updateHeight);\n    updateHeight();\n    return () => window.removeEventListener('resize', updateHeight);\n  }, []);\n\n  return windowHeight;\n}\n\nexport function usePrevious<T>(state: T): T | undefined {\n  const ref = React.useRef<T>();\n\n  React.useEffect(() => {\n    ref.current = state;\n  });\n\n  return ref.current;\n}\n\n// Userland version of the `useEvent` React hook:\n// RFC: https://github.com/reactjs/rfcs/blob/useevent/text/0000-useevent.md\nexport function useEvent<T extends (...args: any[]) => any>(handler: T) {\n  const handlerRef = React.useRef<T>();\n\n  useIsomorphicLayoutEffect(() => {\n    handlerRef.current = handler;\n  });\n\n  return React.useCallback((...args: any[]) => {\n    const fn = handlerRef.current;\n    return fn?.(...args);\n  }, []) as T;\n}\n\n// This is a hacky way to fix a bug in framer-motion where the drag\n// constraints are not updated when window is resized.\n// https://github.com/framer/motion/issues/1659\nconst constraints: BoundingBox = { bottom: 0, top: 0, left: 0, right: 0 };\n\nexport function useDragConstraints() {\n  const constraintsRef = React.useRef<any>(null);\n  const onMeasureDragConstraints = React.useCallback(() => constraints, []);\n  return { constraintsRef, onMeasureDragConstraints };\n}\n","import * as React from 'react';\nimport { SheetScrollerContextType, SheetContextType } from './types';\n\nexport const SheetContext = React.createContext<SheetContextType | undefined>(\n  undefined\n);\n\nexport const useSheetContext = () => {\n  const context = React.useContext(SheetContext);\n  if (!context) throw Error('Sheet context error');\n  return context;\n};\n\nexport const SheetScrollerContext = React.createContext<\n  SheetScrollerContextType | undefined\n>(undefined);\n\nexport function SheetScrollerContextProvider({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  const sheetContext = useSheetContext();\n  const [disableDrag, setDisableDrag] = React.useState(\n    !!sheetContext.disableDrag\n  );\n\n  function setDragEnabled() {\n    if (!sheetContext.disableDrag) setDisableDrag(false);\n  }\n\n  function setDragDisabled() {\n    if (!disableDrag) setDisableDrag(true);\n  }\n\n  return (\n    <SheetScrollerContext.Provider\n      value={{ disableDrag, setDragEnabled, setDragDisabled }}\n    >\n      {children}\n    </SheetScrollerContext.Provider>\n  );\n}\n\nexport const useSheetScrollerContext = () => {\n  const context = React.useContext(SheetScrollerContext);\n  if (!context) throw Error('Sheet scroller context error');\n  return context;\n};\n","// Source: https://github.com/adobe/react-spectrum/blob/main/packages/@react-aria/overlays/src/usePreventScroll.ts\nimport {\n  chain,\n  getScrollParent,\n  isIOS,\n  useLayoutEffect,\n} from '@react-aria/utils';\n\ninterface PreventScrollOptions {\n  /** Whether the scroll lock is disabled. */\n  isDisabled?: boolean;\n}\n\n// @ts-ignore\nconst visualViewport = typeof window !== 'undefined' && window.visualViewport;\n\n// HTML input types that do not cause the software keyboard to appear.\nconst nonTextInputTypes = new Set([\n  'checkbox',\n  'radio',\n  'range',\n  'color',\n  'file',\n  'image',\n  'button',\n  'submit',\n  'reset',\n]);\n\n// The number of active usePreventScroll calls. Used to determine whether to revert back to the original page style/scroll position\nlet preventScrollCount = 0;\nlet restore: any;\n\n/**\n * Prevents scrolling on the document body on mount, and\n * restores it on unmount. Also ensures that content does not\n * shift due to the scrollbars disappearing.\n */\nexport function usePreventScroll(options: PreventScrollOptions = {}) {\n  let { isDisabled } = options;\n\n  useLayoutEffect(() => {\n    if (isDisabled) {\n      return;\n    }\n\n    preventScrollCount++;\n    if (preventScrollCount === 1) {\n      if (isIOS()) {\n        restore = preventScrollMobileSafari();\n      } else {\n        restore = preventScrollStandard();\n      }\n    }\n\n    return () => {\n      preventScrollCount--;\n      if (preventScrollCount === 0) {\n        restore();\n      }\n    };\n  }, [isDisabled]);\n}\n\n// For most browsers, all we need to do is set `overflow: hidden` on the root element, and\n// add some padding to prevent the page from shifting when the scrollbar is hidden.\nfunction preventScrollStandard() {\n  return chain(\n    setStyle(\n      document.documentElement,\n      'paddingRight',\n      `${window.innerWidth - document.documentElement.clientWidth}px`\n    ),\n    setStyle(document.documentElement, 'overflow', 'hidden')\n  );\n}\n\n// Mobile Safari is a whole different beast. Even with overflow: hidden,\n// it still scrolls the page in many situations:\n//\n// 1. When the bottom toolbar and address bar are collapsed, page scrolling is always allowed.\n// 2. When the keyboard is visible, the viewport does not resize. Instead, the keyboard covers part of\n//    it, so it becomes scrollable.\n// 3. When tapping on an input, the page always scrolls so that the input is centered in the visual viewport.\n//    This may cause even fixed position elements to scroll off the screen.\n// 4. When using the next/previous buttons in the keyboard to navigate between inputs, the whole page always\n//    scrolls, even if the input is inside a nested scrollable element that could be scrolled instead.\n//\n// In order to work around these cases, and prevent scrolling without jankiness, we do a few things:\n//\n// 1. Prevent default on `touchmove` events that are not in a scrollable element. This prevents touch scrolling\n//    on the window.\n// 2. Prevent default on `touchmove` events inside a scrollable element when the scroll position is at the\n//    top or bottom. This avoids the whole page scrolling instead, but does prevent overscrolling.\n// 3. Prevent default on `touchend` events on input elements and handle focusing the element ourselves.\n// 4. When focusing an input, apply a transform to trick Safari into thinking the input is at the top\n//    of the page, which prevents it from scrolling the page. After the input is focused, scroll the element\n//    into view ourselves, without scrolling the whole page.\n// 5. Offset the body by the scroll position using a negative margin and scroll to the top. This should appear the\n//    same visually, but makes the actual scroll position always zero. This is required to make all of the\n//    above work or Safari will still try to scroll the page when focusing an input.\n// 6. As a last resort, handle window scroll events, and scroll back to the top. This can happen when attempting\n//    to navigate to an input with the next/previous buttons that's outside a modal.\nfunction preventScrollMobileSafari() {\n  let scrollable: Element;\n  let lastY = 0;\n  let onTouchStart = (e: TouchEvent) => {\n    // Store the nearest scrollable parent element from the element that the user touched.\n    scrollable = getScrollParent(e.target as Element);\n    if (\n      scrollable === document.documentElement &&\n      scrollable === document.body\n    ) {\n      return;\n    }\n\n    lastY = e.changedTouches[0].pageY;\n  };\n\n  let onTouchMove = (e: TouchEvent) => {\n    // Prevent scrolling the window.\n    if (\n      scrollable === document.documentElement ||\n      scrollable === document.body\n    ) {\n      e.preventDefault();\n      return;\n    }\n\n    // Prevent scrolling up when at the top and scrolling down when at the bottom\n    // of a nested scrollable area, otherwise mobile Safari will start scrolling\n    // the window instead. Unfortunately, this disables bounce scrolling when at\n    // the top but it's the best we can do.\n    let y = e.changedTouches[0].pageY;\n    let scrollTop = scrollable.scrollTop;\n    let bottom = scrollable.scrollHeight - scrollable.clientHeight;\n\n    // Fix for: https://github.com/adobe/react-spectrum/pull/3780/files\n    if (bottom === 0) {\n      return;\n    }\n\n    if ((scrollTop <= 0 && y > lastY) || (scrollTop >= bottom && y < lastY)) {\n      e.preventDefault();\n    }\n\n    lastY = y;\n  };\n\n  let onTouchEnd = (e: TouchEvent) => {\n    let target = e.target as HTMLElement;\n\n    // Apply this change if we're not already focused on the target element\n    if (willOpenKeyboard(target) && target !== document.activeElement) {\n      e.preventDefault();\n\n      // Apply a transform to trick Safari into thinking the input is at the top of the page\n      // so it doesn't try to scroll it into view. When tapping on an input, this needs to\n      // be done before the \"focus\" event, so we have to focus the element ourselves.\n      target.style.transform = 'translateY(-2000px)';\n      target.focus();\n      requestAnimationFrame(() => {\n        target.style.transform = '';\n      });\n    }\n  };\n\n  let onFocus = (e: FocusEvent) => {\n    let target = e.target as HTMLElement;\n    if (willOpenKeyboard(target)) {\n      // Transform also needs to be applied in the focus event in cases where focus moves\n      // other than tapping on an input directly, e.g. the next/previous buttons in the\n      // software keyboard. In these cases, it seems applying the transform in the focus event\n      // is good enough, whereas when tapping an input, it must be done before the focus event. 🤷‍♂️\n      target.style.transform = 'translateY(-2000px)';\n      requestAnimationFrame(() => {\n        target.style.transform = '';\n\n        // This will have prevented the browser from scrolling the focused element into view,\n        // so we need to do this ourselves in a way that doesn't cause the whole page to scroll.\n        if (visualViewport) {\n          if (visualViewport.height < window.innerHeight) {\n            // If the keyboard is already visible, do this after one additional frame\n            // to wait for the transform to be removed.\n            requestAnimationFrame(() => {\n              scrollIntoView(target);\n            });\n          } else {\n            // Otherwise, wait for the visual viewport to resize before scrolling so we can\n            // measure the correct position to scroll to.\n            visualViewport.addEventListener(\n              'resize',\n              () => scrollIntoView(target),\n              { once: true }\n            );\n          }\n        }\n      });\n    }\n  };\n\n  let onWindowScroll = () => {\n    // Last resort. If the window scrolled, scroll it back to the top.\n    // It should always be at the top because the body will have a negative margin (see below).\n    window.scrollTo(0, 0);\n  };\n\n  // Record the original scroll position so we can restore it.\n  // Then apply a negative margin to the body to offset it by the scroll position. This will\n  // enable us to scroll the window to the top, which is required for the rest of this to work.\n  let scrollX = window.pageXOffset;\n  let scrollY = window.pageYOffset;\n\n  let restoreStyles = chain(\n    setStyle(\n      document.documentElement,\n      'paddingRight',\n      `${window.innerWidth - document.documentElement.clientWidth}px`\n    ),\n    setStyle(document.documentElement, 'overflow', 'hidden'),\n    setStyle(document.body, 'marginTop', `-${scrollY}px`)\n  );\n\n  // Scroll to the top. The negative margin on the body will make this appear the same.\n  window.scrollTo(0, 0);\n\n  let removeEvents = chain(\n    addEvent(document, 'touchstart', onTouchStart, {\n      passive: false,\n      capture: true,\n    }),\n    addEvent(document, 'touchmove', onTouchMove, {\n      passive: false,\n      capture: true,\n    }),\n    addEvent(document, 'touchend', onTouchEnd, {\n      passive: false,\n      capture: true,\n    }),\n    addEvent(document, 'focus', onFocus, true),\n    addEvent(window, 'scroll', onWindowScroll)\n  );\n\n  return () => {\n    // Restore styles and scroll the page back to where it was.\n    restoreStyles();\n    removeEvents();\n    window.scrollTo(scrollX, scrollY);\n  };\n}\n\n// Sets a CSS property on an element, and returns a function to revert it to the previous value.\nfunction setStyle(element: any, style: string, value: string) {\n  let cur = element.style[style];\n  element.style[style] = value;\n\n  return () => {\n    element.style[style] = cur;\n  };\n}\n\n// Adds an event listener to an element, and returns a function to remove it.\nfunction addEvent<K extends keyof GlobalEventHandlersEventMap>(\n  target: EventTarget,\n  event: K,\n  handler: (this: Document, ev: GlobalEventHandlersEventMap[K]) => any,\n  options?: boolean | AddEventListenerOptions\n) {\n  target.addEventListener(event, handler as any, options);\n  return () => {\n    target.removeEventListener(event, handler as any, options);\n  };\n}\n\nfunction scrollIntoView(target: Element) {\n  let root = document.scrollingElement || document.documentElement;\n  while (target && target !== root) {\n    // Find the parent scrollable element and adjust the scroll position if the target is not already in view.\n    let scrollable = getScrollParent(target);\n    if (\n      scrollable !== document.documentElement &&\n      scrollable !== document.body &&\n      scrollable !== target\n    ) {\n      let scrollableTop = scrollable.getBoundingClientRect().top;\n      let targetTop = target.getBoundingClientRect().top;\n      if (targetTop > scrollableTop + target.clientHeight) {\n        scrollable.scrollTop += targetTop - scrollableTop;\n      }\n    }\n\n    target = scrollable.parentElement as any;\n  }\n}\n\nfunction willOpenKeyboard(target: Element) {\n  return (\n    (target instanceof HTMLInputElement &&\n      !nonTextInputTypes.has(target.type)) ||\n    target instanceof HTMLTextAreaElement ||\n    (target instanceof HTMLElement && target.isContentEditable)\n  );\n}\n","import * as CSS from 'csstype';\n\nconst styles: { [key: string]: CSS.Properties } = {\n  wrapper: {\n    position: 'fixed',\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    overflow: 'hidden',\n    pointerEvents: 'none',\n  },\n  backdrop: {\n    zIndex: 1,\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n    backgroundColor: 'rgba(0, 0, 0, 0.2)',\n    touchAction: 'none', // Disable iOS body scrolling\n    border: 'none',\n  },\n  container: {\n    zIndex: 2,\n    position: 'absolute',\n    left: 0,\n    bottom: 0,\n    width: '100%',\n    backgroundColor: '#fff',\n    borderTopRightRadius: '8px',\n    borderTopLeftRadius: '8px',\n    boxShadow: '0px -2px 16px rgba(0, 0, 0, 0.3)',\n    display: 'flex',\n    flexDirection: 'column',\n    pointerEvents: 'auto',\n  },\n  headerWrapper: {\n    width: '100%',\n  },\n  header: {\n    height: '40px',\n    width: '100%',\n    position: 'relative',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  indicator: {\n    width: '18px',\n    height: '4px',\n    borderRadius: '99px',\n    backgroundColor: '#ddd',\n  },\n  content: {\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    minHeight: '0px',\n    position: 'relative',\n  },\n  scroller: {\n    height: '100%',\n    overflowY: 'auto',\n  },\n};\n\nexport default styles;\n","import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\n\nimport {\n  animate,\n  AnimatePresence,\n  motion,\n  PanInfo,\n  Transition,\n  useMotionValue,\n  useReducedMotion,\n  useTransform,\n} from 'framer-motion';\n\nimport {\n  useModalEffect,\n  useWindowHeight,\n  useIsomorphicLayoutEffect,\n  useEvent,\n} from './hooks';\n\nimport {\n  REDUCED_MOTION_TWEEN_CONFIG,\n  DEFAULT_TWEEN_CONFIG,\n  DRAG_CLOSE_THRESHOLD,\n  DRAG_VELOCITY_THRESHOLD,\n  IS_SSR,\n} from './constants';\n\nimport { SheetContextType, SheetProps } from './types';\nimport { SheetScrollerContextProvider, SheetContext } from './context';\nimport { getClosest, inDescendingOrder, validateSnapTo } from './utils';\nimport { usePreventScroll } from './use-prevent-scroll';\nimport styles from './styles';\n\nconst Sheet = React.forwardRef<any, SheetProps>(\n  (\n    {\n      onOpenStart,\n      onOpenEnd,\n      onClose,\n      onCloseStart,\n      onCloseEnd,\n      onSnap,\n      children,\n      disableScrollLocking = false,\n      isOpen,\n      snapPoints,\n      rootId,\n      mountPoint,\n      style,\n      detent = 'full-height',\n      initialSnap = 0,\n      disableDrag = false,\n      prefersReducedMotion = false,\n      tweenConfig = DEFAULT_TWEEN_CONFIG,\n      ...rest\n    },\n    ref\n  ) => {\n    const sheetRef = React.useRef<any>(null);\n    const indicatorRotation = useMotionValue(0);\n    const windowHeight = useWindowHeight();\n    const shouldReduceMotion = useReducedMotion();\n    const reduceMotion = Boolean(prefersReducedMotion || shouldReduceMotion);\n    const animationOptions: Transition = {\n      type: 'tween',\n      ...(reduceMotion ? REDUCED_MOTION_TWEEN_CONFIG : tweenConfig),\n    };\n\n    // NOTE: the inital value for `y` doesn't matter since it is overwritten by\n    // the value driven by the `AnimatePresence` component when the sheet is opened\n    // and after that it is driven by the gestures and/or snapping\n    const y = useMotionValue(0);\n\n    const zIndex = useTransform(y, value =>\n      value >= windowHeight ? -1 : 9999999\n    );\n\n    const visibility = useTransform(y, value =>\n      value >= windowHeight ? 'hidden' : 'visible'\n    );\n\n    // Keep the callback fns up-to-date so that they can be accessed inside\n    // the effect without including them to the dependencies array\n    const callbacks = React.useRef({\n      onOpenStart,\n      onOpenEnd,\n      onCloseStart,\n      onCloseEnd,\n    });\n\n    useIsomorphicLayoutEffect(() => {\n      callbacks.current = {\n        onOpenStart,\n        onOpenEnd,\n        onCloseStart,\n        onCloseEnd,\n      };\n    });\n\n    if (snapPoints) {\n      // Convert negative / percentage snap points to absolute values\n      snapPoints = snapPoints.map(point => {\n        // Percentage values e.g. between 0.0 and 1.0\n        if (point > 0 && point <= 1) return Math.round(point * windowHeight);\n        return point < 0 ? windowHeight + point : point; // negative values\n      });\n\n      console.assert(\n        inDescendingOrder(snapPoints) || windowHeight === 0,\n        `Snap points need to be in descending order got: [${snapPoints}]`\n      );\n    }\n\n    const onDrag = useEvent((_, { delta }: PanInfo) => {\n      // Update drag indicator rotation based on drag velocity\n      const velocity = y.getVelocity();\n\n      if (velocity > 0) indicatorRotation.set(10);\n      if (velocity < 0) indicatorRotation.set(-10);\n\n      // Make sure user cannot drag beyond the top of the sheet\n      y.set(Math.max(y.get() + delta.y, 0));\n    });\n\n    const onDragEnd = useEvent((_, { velocity }: PanInfo) => {\n      if (velocity.y > DRAG_VELOCITY_THRESHOLD) {\n        // User flicked the sheet down\n        onClose();\n      } else {\n        const sheetEl = sheetRef.current as HTMLDivElement;\n        const sheetHeight = sheetEl.getBoundingClientRect().height;\n        const currentY = y.get();\n\n        let snapTo = 0;\n\n        if (snapPoints) {\n          const snapToValues = snapPoints.map(\n            p => sheetHeight - Math.min(p, sheetHeight)\n          );\n\n          // Allow snapping to the top of the sheet if detent is set to `content-height`\n          if (detent === 'content-height' && !snapToValues.includes(0)) {\n            snapToValues.unshift(0);\n          }\n\n          // Get the closest snap point\n          snapTo = getClosest(snapToValues, currentY);\n        } else if (currentY / sheetHeight > DRAG_CLOSE_THRESHOLD) {\n          // Close if dragged over enough far\n          snapTo = sheetHeight;\n        }\n\n        snapTo = validateSnapTo({ snapTo, sheetHeight });\n\n        // Update the spring value so that the sheet is animated to the snap point\n        animate(y, snapTo, animationOptions);\n\n        if (snapPoints && onSnap) {\n          const snapValue = Math.abs(Math.round(snapPoints[0] - snapTo));\n          const snapIndex = snapPoints.indexOf(getClosest(snapPoints, snapValue)); // prettier-ignore\n          onSnap(snapIndex);\n        }\n\n        const roundedSheetHeight = Math.round(sheetHeight);\n        const shouldClose = snapTo >= roundedSheetHeight;\n\n        if (shouldClose) onClose();\n      }\n\n      // Reset indicator rotation after dragging\n      indicatorRotation.set(0);\n    });\n\n    // Trigger onSnap callback when sheet is opened or closed\n    React.useEffect(() => {\n      if (!snapPoints || !onSnap) return;\n      const snapIndex = isOpen ? initialSnap : snapPoints.length - 1;\n      onSnap(snapIndex);\n    }, [isOpen]); // eslint-disable-line\n\n    React.useImperativeHandle(ref, () => ({\n      y,\n      snapTo: (snapIndex: number) => {\n        const sheetEl = sheetRef.current as HTMLDivElement | null;\n\n        if (\n          snapPoints &&\n          snapPoints[snapIndex] !== undefined &&\n          sheetEl !== null\n        ) {\n          const sheetHeight = sheetEl.getBoundingClientRect().height;\n          const snapPoint = snapPoints[snapIndex];\n          const snapTo = validateSnapTo({\n            snapTo: sheetHeight - snapPoint,\n            sheetHeight,\n          });\n\n          animate(y, snapTo, animationOptions);\n          if (onSnap) onSnap(snapIndex);\n          if (snapTo >= sheetHeight) onClose();\n        }\n      },\n    }));\n\n    useModalEffect(isOpen, rootId);\n\n    // Framer Motion should handle body scroll locking but it's not working\n    // properly on iOS. Scroll locking from React Aria seems to work much better.\n    usePreventScroll({ isDisabled: disableScrollLocking === true || !isOpen });\n\n    const dragProps = React.useMemo(() => {\n      const dragProps: SheetContextType['dragProps'] = {\n        drag: 'y',\n        dragElastic: 0,\n        dragMomentum: false,\n        dragPropagation: false,\n        onDrag,\n        onDragEnd,\n      };\n\n      return disableDrag ? undefined : dragProps;\n    }, [disableDrag]); // eslint-disable-line\n\n    const context: SheetContextType = {\n      y,\n      sheetRef,\n      isOpen,\n      initialSnap,\n      snapPoints,\n      detent,\n      indicatorRotation,\n      callbacks,\n      dragProps,\n      windowHeight,\n      animationOptions,\n      reduceMotion,\n      disableDrag,\n    };\n\n    const sheet = (\n      <SheetContext.Provider value={context}>\n        <motion.div\n          {...rest}\n          ref={ref}\n          style={{ ...styles.wrapper, zIndex, visibility, ...style }}\n        >\n          <AnimatePresence>\n            {/* NOTE: AnimatePresence requires us to set keys to children */}\n            {isOpen ? (\n              <SheetScrollerContextProvider>\n                {React.Children.map(children, (child: any, i) =>\n                  React.cloneElement(child, { key: `sheet-child-${i}` })\n                )}\n              </SheetScrollerContextProvider>\n            ) : null}\n          </AnimatePresence>\n        </motion.div>\n      </SheetContext.Provider>\n    );\n\n    if (IS_SSR) return sheet;\n\n    return ReactDOM.createPortal(sheet, mountPoint ?? document.body);\n  }\n);\n\nexport default Sheet;\n","import * as React from 'react';\nimport { motion } from 'framer-motion';\n\nimport { SheetContainerProps } from './types';\nimport { useSheetContext } from './context';\nimport { useEventCallbacks } from './hooks';\nimport { MAX_HEIGHT } from './constants';\nimport { mergeRefs } from './utils';\nimport styles from './styles';\n\nconst SheetContainer = React.forwardRef<any, SheetContainerProps>(\n  ({ children, style = {}, className = '', ...rest }, ref) => {\n    const {\n      y,\n      isOpen,\n      callbacks,\n      snapPoints,\n      initialSnap = 0,\n      sheetRef,\n      windowHeight,\n      detent,\n      animationOptions,\n      reduceMotion,\n    } = useSheetContext();\n\n    const { handleAnimationComplete } = useEventCallbacks(isOpen, callbacks);\n    const initialY = snapPoints ? snapPoints[0] - snapPoints[initialSnap] : 0;\n    const maxSnapHeight = snapPoints ? snapPoints[0] : null;\n\n    const height =\n      maxSnapHeight !== null\n        ? `min(${maxSnapHeight}px, ${MAX_HEIGHT})`\n        : MAX_HEIGHT;\n\n    return (\n      <motion.div\n        {...rest}\n        ref={mergeRefs([sheetRef, ref])}\n        className={`react-modal-sheet-container ${className}`}\n        style={{\n          ...styles.container,\n          ...style,\n          ...(detent === 'full-height' && { height }),\n          ...(detent === 'content-height' && { maxHeight: height }),\n          y,\n        }}\n        initial={reduceMotion ? false : { y: windowHeight }}\n        animate={{ y: initialY, transition: animationOptions }}\n        exit={{ y: windowHeight, transition: animationOptions }}\n        onAnimationComplete={handleAnimationComplete}\n      >\n        {children}\n      </motion.div>\n    );\n  }\n);\n\nexport default SheetContainer;\n","import * as React from 'react';\nimport { motion } from 'framer-motion';\n\nimport { SheetDraggableProps } from './types';\nimport { useSheetScrollerContext, useSheetContext } from './context';\nimport { useDragConstraints } from './hooks';\nimport { mergeRefs } from './utils';\nimport styles from './styles';\n\nconst SheetContent = React.forwardRef<any, SheetDraggableProps>(\n  ({ children, style, disableDrag, className = '', ...rest }, ref) => {\n    const sheetContext = useSheetContext();\n    const sheetScrollerContext = useSheetScrollerContext();\n    const { constraintsRef, onMeasureDragConstraints } = useDragConstraints();\n\n    const dragProps =\n      disableDrag || sheetScrollerContext.disableDrag\n        ? undefined\n        : sheetContext.dragProps;\n\n    return (\n      <motion.div\n        {...rest}\n        ref={mergeRefs([ref, constraintsRef])}\n        className={`react-modal-sheet-content ${className}`}\n        style={{ ...styles.content, ...style }}\n        {...dragProps}\n        dragConstraints={constraintsRef}\n        onMeasureDragConstraints={onMeasureDragConstraints}\n      >\n        {children}\n      </motion.div>\n    );\n  }\n);\n\nexport default SheetContent;\n","import * as React from 'react';\nimport { motion, useTransform } from 'framer-motion';\n\nimport { SheetDraggableProps } from './types';\nimport { useSheetContext } from './context';\nimport { useDragConstraints } from './hooks';\nimport { mergeRefs } from './utils';\nimport styles from './styles';\n\nconst SheetHeader = React.forwardRef<any, SheetDraggableProps>(\n  ({ children, style, disableDrag, ...rest }, ref) => {\n    const { indicatorRotation, dragProps } = useSheetContext();\n    const { constraintsRef, onMeasureDragConstraints } = useDragConstraints();\n    const _dragProps = disableDrag ? undefined : dragProps;\n\n    const indicator1Transform = useTransform(\n      indicatorRotation,\n      r => `translateX(2px) rotate(${r}deg)`\n    );\n\n    const indicator2Transform = useTransform(\n      indicatorRotation,\n      r => `translateX(-2px) rotate(${-1 * r}deg)`\n    );\n\n    return (\n      <motion.div\n        {...rest}\n        ref={mergeRefs([ref, constraintsRef])}\n        style={{ ...styles.headerWrapper, ...style }}\n        {..._dragProps}\n        dragConstraints={constraintsRef}\n        onMeasureDragConstraints={onMeasureDragConstraints}\n      >\n        {children || (\n          <div className=\"react-modal-sheet-header\" style={styles.header}>\n            <motion.span\n              className=\"react-modal-sheet-drag-indicator\"\n              style={{ ...styles.indicator, transform: indicator1Transform }}\n            />\n            <motion.span\n              className=\"react-modal-sheet-drag-indicator\"\n              style={{ ...styles.indicator, transform: indicator2Transform }}\n            />\n          </div>\n        )}\n      </motion.div>\n    );\n  }\n);\n\nexport default SheetHeader;\n","import * as React from 'react';\nimport { motion } from 'framer-motion';\n\nimport { SheetBackdropProps } from './types';\nimport styles from './styles';\n\nconst isClickable = (props: any) => !!props.onClick || !!props.onTap;\n\nconst SheetBackdrop = React.forwardRef<any, SheetBackdropProps>(\n  ({ style = {}, className = '', ...rest }, ref) => {\n    const Comp = isClickable(rest) ? motion.button : motion.div;\n    const pointerEvents = isClickable(rest) ? 'auto' : 'none';\n\n    return (\n      <Comp\n        {...rest}\n        ref={ref}\n        className={`react-modal-sheet-backdrop ${className}`}\n        style={{ ...styles.backdrop, ...style, pointerEvents }}\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        exit={{ opacity: 0 }}\n      />\n    );\n  }\n);\n\nexport default SheetBackdrop;\n","import * as React from 'react';\n\nimport { useSheetScrollerContext } from './context';\nimport { SheetScrollerProps } from './types';\nimport { isTouchDevice } from './utils';\nimport styles from './styles';\n\nconst SheetScroller = React.forwardRef<any, SheetScrollerProps>(\n  ({ draggableAt = 'top', children, style, className = '', ...rest }, ref) => {\n    const sheetScrollerContext = useSheetScrollerContext();\n\n    function determineDragState(element: HTMLDivElement) {\n      const { scrollTop, scrollHeight, clientHeight } = element;\n      const isScrollable = scrollHeight > clientHeight;\n\n      if (!isScrollable) return;\n\n      const isAtTop = scrollTop <= 0;\n      const isAtBottom = scrollHeight - scrollTop === clientHeight;\n\n      const shouldEnable =\n        (draggableAt === 'top' && isAtTop) ||\n        (draggableAt === 'bottom' && isAtBottom) ||\n        (draggableAt === 'both' && (isAtTop || isAtBottom));\n\n      if (shouldEnable) {\n        sheetScrollerContext.setDragEnabled();\n      } else {\n        sheetScrollerContext.setDragDisabled();\n      }\n    }\n\n    function onScroll(e: React.UIEvent<HTMLDivElement>) {\n      determineDragState(e.currentTarget);\n    }\n\n    function onTouchStart(e: React.TouchEvent<HTMLDivElement>) {\n      determineDragState(e.currentTarget);\n    }\n\n    const scrollProps = isTouchDevice()\n      ? { onScroll, onTouchStart }\n      : undefined;\n\n    return (\n      <div\n        {...rest}\n        ref={ref}\n        className={`react-modal-sheet-scroller ${className}`}\n        style={{ ...styles.scroller, ...style }}\n        {...scrollProps}\n      >\n        {children}\n      </div>\n    );\n  }\n);\n\nexport default SheetScroller;\n","import { MotionValue } from 'framer-motion';\n\nimport Sheet from './sheet';\nimport SheetContainer from './SheetContainer';\nimport SheetContent from './SheetContent';\nimport SheetHeader from './SheetHeader';\nimport SheetBackdrop from './SheetBackdrop';\nimport SheetScroller from './SheetScroller';\nimport { SheetCompound } from './types';\n\nexport type SheetRef = {\n  y: MotionValue<number>;\n  snapTo: (index: number) => void;\n};\n\n// HACK: this is needed to get the typing to work properly...\nconst _SheetCompound: any = Sheet;\n_SheetCompound.Container = SheetContainer;\n_SheetCompound.Header = SheetHeader;\n_SheetCompound.Content = SheetContent;\n_SheetCompound.Backdrop = SheetBackdrop;\n_SheetCompound.Scroller = SheetScroller;\n\nexport default _SheetCompound as SheetCompound;\n"],"names":["MAX_HEIGHT","IS_SSR","window","DEFAULT_TWEEN_CONFIG","ease","duration","REDUCED_MOTION_TWEEN_CONFIG","getClosest","nums","goal","closest","minDifference","Math","abs","i","length","difference","cleanupRootStyles","rootId","body","document","querySelector","root","getElementById","style","removeProperty","addEventListener","onTransitionEnd","removeEventListener","validateSnapTo","_ref","snapTo","sheetHeight","console","warn","max","round","mergeRefs","refs","value","forEach","ref","current","useIsomorphicLayoutEffect","React","usePrevious","state","useEvent","handler","handlerRef","fn","_len","arguments","args","Array","_key","apply","constraints","bottom","top","left","right","useDragConstraints","constraintsRef","onMeasureDragConstraints","SheetContext","undefined","useSheetContext","context","Error","SheetScrollerContext","SheetScrollerContextProvider","children","sheetContext","_React$useState","disableDrag","setDisableDrag","Provider","setDragEnabled","setDragDisabled","restore","useSheetScrollerContext","visualViewport","nonTextInputTypes","Set","preventScrollCount","setStyle","element","cur","addEvent","target","event","options","scrollIntoView","scrollingElement","documentElement","scrollable","getScrollParent","scrollableTop","getBoundingClientRect","targetTop","clientHeight","scrollTop","parentElement","willOpenKeyboard","HTMLInputElement","has","type","HTMLTextAreaElement","HTMLElement","isContentEditable","styles","wrapper","position","overflow","pointerEvents","backdrop","zIndex","width","height","backgroundColor","touchAction","border","container","borderTopRightRadius","borderTopLeftRadius","boxShadow","display","flexDirection","headerWrapper","header","alignItems","justifyContent","indicator","borderRadius","content","flexGrow","minHeight","scroller","overflowY","Sheet","onOpenStart","onOpenEnd","onClose","onCloseStart","onCloseEnd","onSnap","_ref$disableScrollLoc","disableScrollLocking","isOpen","snapPoints","mountPoint","_ref$detent","detent","_ref$initialSnap","initialSnap","_ref$disableDrag","_ref$prefersReducedMo","prefersReducedMotion","_ref$tweenConfig","tweenConfig","rest","_objectWithoutPropertiesLoose","_excluded","sheetRef","indicatorRotation","useMotionValue","windowHeight","setWindowHeight","updateHeight","innerHeight","useWindowHeight","shouldReduceMotion","useReducedMotion","reduceMotion","Boolean","animationOptions","_extends","y","useTransform","visibility","callbacks","map","point","assert","arr","inDescendingOrder","onDrag","_","_ref2","delta","velocity","getVelocity","set","get","onDragEnd","_ref3","currentY","snapToValues","p","min","includes","unshift","animate","snapValue","snapIndex","indexOf","sheetEl","prevOpen","h","s","willChange","transition","transform","applyRootStyles","useModalEffect","isDisabled","useLayoutEffect","isIOS","lastY","scrollX","pageXOffset","scrollY","pageYOffset","restoreStyles","chain","innerWidth","clientWidth","scrollTo","removeEvents","e","changedTouches","pageY","passive","capture","scrollHeight","preventDefault","activeElement","focus","requestAnimationFrame","once","preventScrollMobileSafari","usePreventScroll","dragProps","drag","dragElastic","dragMomentum","dragPropagation","sheet","motion","div","AnimatePresence","child","key","ReactDOM","SheetContainer","_ref$style","_ref$className","className","_useSheetContext","_useSheetContext$init","handleAnimationComplete","didOpen","useEventCallbacks","initialY","maxSnapHeight","maxHeight","initial","exit","onAnimationComplete","SheetContent","sheetScrollerContext","_useDragConstraints","dragConstraints","SheetHeader","_dragProps","indicator1Transform","r","indicator2Transform","span","isClickable","props","onClick","onTap","SheetBackdrop","Comp","button","opacity","SheetScroller","draggableAt","_ref$draggableAt","determineDragState","isAtTop","isAtBottom","scrollProps","navigator","maxTouchPoints","onScroll","currentTarget","onTouchStart","_SheetCompound","Container","Header","Content","Backdrop","Scroller"],"mappings":"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"}