"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("react-dom"),n=require("framer-motion"),r=require("@react-aria/utils");function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function i(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t.indexOf(n=i[r])>=0||(o[n]=e[n]);return o}var a="calc(100% - env(safe-area-inset-top) - 34px)",s="undefined"==typeof window,c={ease:"easeOut",duration:.2},l={ease:"linear",duration:.01};function u(e,t){for(var n=e[0],r=Math.abs(e[0]-t),o=1;o<e.length;o++){var i=Math.abs(e[o]-t);i<r&&(n=e[o],r=i)}return n}function d(e){var t=document.querySelector("body"),n=document.getElementById(e);n&&(n.style.removeProperty("border-top-right-radius"),n.style.removeProperty("border-top-left-radius"),n.style.removeProperty("transform"),n.addEventListener("transitionend",(function e(){n.style.removeProperty("overflow"),n.style.removeProperty("will-change"),n.style.removeProperty("transition"),t.style.removeProperty("background-color"),n.removeEventListener("transitionend",e)})))}function f(e){var t=e.snapTo,n=e.sheetHeight;return t<0&&console.warn("Snap point is out of bounds. Sheet height is "+n+" but snap point is "+(n+Math.abs(t))+"."),Math.max(Math.round(t),0)}function m(e){return function(t){e.forEach((function(e){"function"==typeof e?e(t):e&&(e.current=t)}))}}var p=s?e.useEffect:e.useLayoutEffect;function h(t){var n=e.useRef();return e.useEffect((function(){n.current=t})),n.current}function g(t){var n=e.useRef();return p((function(){n.current=t})),e.useCallback((function(){for(var e=n.current,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return null==e?void 0:e.apply(void 0,r)}),[])}var v={bottom:0,top:0,left:0,right:0};function y(){return{constraintsRef:e.useRef(null),onMeasureDragConstraints:e.useCallback((function(){return v}),[])}}var b=e.createContext(void 0),w=function(){var t=e.useContext(b);if(!t)throw Error("Sheet context error");return t},E=e.createContext(void 0);function x(t){var n=t.children,r=w(),o=e.useState(!!r.disableDrag),i=o[0],a=o[1];return e.createElement(E.Provider,{value:{disableDrag:i,setDragEnabled:function(){r.disableDrag||a(!1)},setDragDisabled:function(){i||a(!0)}}},n)}var C,S=function(){var t=e.useContext(E);if(!t)throw Error("Sheet scroller context error");return t},O="undefined"!=typeof window&&window.visualViewport,R=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]),D=0;function T(e,t,n){var r=e.style[t];return e.style[t]=n,function(){e.style[t]=r}}function M(e,t,n,r){return e.addEventListener(t,n,r),function(){e.removeEventListener(t,n,r)}}function P(e){for(var t=document.scrollingElement||document.documentElement;e&&e!==t;){var n=r.getScrollParent(e);if(n!==document.documentElement&&n!==document.body&&n!==e){var o=n.getBoundingClientRect().top,i=e.getBoundingClientRect().top;i>o+e.clientHeight&&(n.scrollTop+=i-o)}e=n.parentElement}}function k(e){return e instanceof HTMLInputElement&&!R.has(e.type)||e instanceof HTMLTextAreaElement||e instanceof HTMLElement&&e.isContentEditable}var H={wrapper:{position:"fixed",top:0,bottom:0,left:0,right:0,overflow:"hidden",pointerEvents:"none"},backdrop:{zIndex:1,position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.2)",touchAction:"none",border:"none"},container:{zIndex:2,position:"absolute",left:0,bottom:0,width:"100%",backgroundColor:"#fff",borderTopRightRadius:"8px",borderTopLeftRadius:"8px",boxShadow:"0px -2px 16px rgba(0, 0, 0, 0.3)",display:"flex",flexDirection:"column",pointerEvents:"auto"},headerWrapper:{width:"100%"},header:{height:"40px",width:"100%",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},indicator:{width:"18px",height:"4px",borderRadius:"99px",backgroundColor:"#ddd"},content:{flexGrow:1,display:"flex",flexDirection:"column",minHeight:"0px",position:"relative"},scroller:{height:"100%",overflowY:"auto"}},L=["onOpenStart","onOpenEnd","onClose","onCloseStart","onCloseEnd","onSnap","children","disableScrollLocking","isOpen","snapPoints","rootId","mountPoint","style","detent","initialSnap","disableDrag","prefersReducedMotion","tweenConfig"],N=e.forwardRef((function(a,m){var v=a.onOpenStart,y=a.onOpenEnd,w=a.onClose,E=a.onCloseStart,S=a.onCloseEnd,R=a.onSnap,N=a.children,j=a.disableScrollLocking,A=void 0!==j&&j,q=a.isOpen,I=a.snapPoints,B=a.rootId,Y=a.mountPoint,z=a.style,W=a.detent,V=void 0===W?"full-height":W,F=a.initialSnap,X=void 0===F?0:F,_=a.disableDrag,G=void 0!==_&&_,J=a.prefersReducedMotion,K=void 0!==J&&J,Q=a.tweenConfig,U=void 0===Q?c:Q,Z=i(a,L),$=e.useRef(null),ee=n.useMotionValue(0),te=function(){var t=e.useState(0),n=t[0],r=t[1];return p((function(){var e=function(){return r(window.innerHeight)};return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),n}(),ne=n.useReducedMotion(),re=Boolean(K||ne),oe=o({type:"tween"},re?l:U),ie=n.useMotionValue(0),ae=n.useTransform(ie,(function(e){return e>=te?-1:9999999})),se=n.useTransform(ie,(function(e){return e>=te?"hidden":"visible"})),ce=e.useRef({onOpenStart:v,onOpenEnd:y,onCloseStart:E,onCloseEnd:S});p((function(){ce.current={onOpenStart:v,onOpenEnd:y,onCloseStart:E,onCloseEnd:S}})),I&&(I=I.map((function(e){return e>0&&e<=1?Math.round(e*te):e<0?te+e:e})),console.assert(function(e){for(var t=0;t<e.length;t++)if(e[t+1]>e[t])return!1;return!0}(I)||0===te,"Snap points need to be in descending order got: ["+I+"]"));var le=g((function(e,t){var n=t.delta,r=ie.getVelocity();r>0&&ee.set(10),r<0&&ee.set(-10),ie.set(Math.max(ie.get()+n.y,0))})),ue=g((function(e,t){if(t.velocity.y>500)w();else{var r=$.current.getBoundingClientRect().height,o=ie.get(),i=0;if(I){var a=I.map((function(e){return r-Math.min(e,r)}));"content-height"!==V||a.includes(0)||a.unshift(0),i=u(a,o)}else o/r>.6&&(i=r);if(i=f({snapTo:i,sheetHeight:r}),n.animate(ie,i,oe),I&&R){var s=Math.abs(Math.round(I[0]-i)),c=I.indexOf(u(I,s));R(c)}i>=Math.round(r)&&w()}ee.set(0)}));e.useEffect((function(){I&&R&&R(q?X:I.length-1)}),[q]),e.useImperativeHandle(m,(function(){return{y:ie,snapTo:function(e){var t=$.current;if(I&&void 0!==I[e]&&null!==t){var r=t.getBoundingClientRect().height,o=f({snapTo:r-I[e],sheetHeight:r});n.animate(ie,o,oe),R&&R(e),o>=r&&w()}}}})),function(t,n){var r=h(t);e.useEffect((function(){n&&!r&&t?function(e){var t=document.querySelector("body"),n=document.querySelector("#"+e);if(n){var r=window.innerHeight,o=(r-24)/r;t.style.backgroundColor="#000",n.style.overflow="hidden",n.style.willChange="transform",n.style.transition="transform 200ms ease-in-out, border-radius 200ms linear",n.style.transform="translateY(calc(env(safe-area-inset-top) + 12px)) scale("+o+")",n.style.borderTopRightRadius="10px",n.style.borderTopLeftRadius="10px"}}(n):n&&!t&&r&&d(n)}),[t,r]),e.useEffect((function(){return function(){n&&t&&d(n)}}),[t])}(q,B),function(e){void 0===e&&(e={});var t=e.isDisabled;r.useLayoutEffect((function(){if(!t)return 1==++D&&(C=r.isIOS()?function(){var e,t=0,n=window.pageXOffset,o=window.pageYOffset,i=r.chain(T(document.documentElement,"paddingRight",window.innerWidth-document.documentElement.clientWidth+"px"),T(document.documentElement,"overflow","hidden"),T(document.body,"marginTop","-"+o+"px"));window.scrollTo(0,0);var a=r.chain(M(document,"touchstart",(function(n){(e=r.getScrollParent(n.target))===document.documentElement&&e===document.body||(t=n.changedTouches[0].pageY)}),{passive:!1,capture:!0}),M(document,"touchmove",(function(n){if(e!==document.documentElement&&e!==document.body){var r=n.changedTouches[0].pageY,o=e.scrollTop,i=e.scrollHeight-e.clientHeight;0!==i&&((o<=0&&r>t||o>=i&&r<t)&&n.preventDefault(),t=r)}else n.preventDefault()}),{passive:!1,capture:!0}),M(document,"touchend",(function(e){var t=e.target;k(t)&&t!==document.activeElement&&(e.preventDefault(),t.style.transform="translateY(-2000px)",t.focus(),requestAnimationFrame((function(){t.style.transform=""})))}),{passive:!1,capture:!0}),M(document,"focus",(function(e){var t=e.target;k(t)&&(t.style.transform="translateY(-2000px)",requestAnimationFrame((function(){t.style.transform="",O&&(O.height<window.innerHeight?requestAnimationFrame((function(){P(t)})):O.addEventListener("resize",(function(){return P(t)}),{once:!0}))})))}),!0),M(window,"scroll",(function(){window.scrollTo(0,0)})));return function(){i(),a(),window.scrollTo(n,o)}}():r.chain(T(document.documentElement,"paddingRight",window.innerWidth-document.documentElement.clientWidth+"px"),T(document.documentElement,"overflow","hidden"))),function(){0==--D&&C()}}),[t])}({isDisabled:!0===A||!q});var de=e.useMemo((function(){return G?void 0:{drag:"y",dragElastic:0,dragMomentum:!1,dragPropagation:!1,onDrag:le,onDragEnd:ue}}),[G]),fe=e.createElement(b.Provider,{value:{y:ie,sheetRef:$,isOpen:q,initialSnap:X,snapPoints:I,detent:V,indicatorRotation:ee,callbacks:ce,dragProps:de,windowHeight:te,animationOptions:oe,reduceMotion:re,disableDrag:G}},e.createElement(n.motion.div,Object.assign({},Z,{ref:m,style:o({},H.wrapper,{zIndex:ae,visibility:se},z)}),e.createElement(n.AnimatePresence,null,q?e.createElement(x,null,e.Children.map(N,(function(t,n){return e.cloneElement(t,{key:"sheet-child-"+n})}))):null)));return s?fe:t.createPortal(fe,null!=Y?Y:document.body)})),j=["children","style","className"],A=e.forwardRef((function(t,r){var s=t.children,c=t.style,l=void 0===c?{}:c,u=t.className,d=void 0===u?"":u,f=i(t,j),p=w(),g=p.y,v=p.snapPoints,y=p.initialSnap,b=void 0===y?0:y,E=p.sheetRef,x=p.windowHeight,C=p.detent,S=p.animationOptions,O=p.reduceMotion,R=function(t,n){var r=h(t),o=e.useRef(!1),i=e.useCallback((function(){o.current?(null==n.current.onCloseEnd||n.current.onCloseEnd(),o.current=!1):(null==n.current.onOpenEnd||n.current.onOpenEnd(),o.current=!0)}),[t,r]);return e.useEffect((function(){!r&&t?null==n.current.onOpenStart||n.current.onOpenStart():!t&&r&&(null==n.current.onCloseStart||n.current.onCloseStart())}),[t,r]),{handleAnimationComplete:i}}(p.isOpen,p.callbacks).handleAnimationComplete,D=v?v[0]-v[b]:0,T=v?v[0]:null,M=null!==T?"min("+T+"px, "+a+")":a;return e.createElement(n.motion.div,Object.assign({},f,{ref:m([E,r]),className:"react-modal-sheet-container "+d,style:o({},H.container,l,"full-height"===C&&{height:M},"content-height"===C&&{maxHeight:M},{y:g}),initial:!O&&{y:x},animate:{y:D,transition:S},exit:{y:x,transition:S},onAnimationComplete:R}),s)})),q=["children","style","disableDrag","className"],I=e.forwardRef((function(t,r){var a=t.children,s=t.style,c=t.disableDrag,l=t.className,u=void 0===l?"":l,d=i(t,q),f=w(),p=S(),h=y(),g=h.constraintsRef,v=h.onMeasureDragConstraints,b=c||p.disableDrag?void 0:f.dragProps;return e.createElement(n.motion.div,Object.assign({},d,{ref:m([r,g]),className:"react-modal-sheet-content "+u,style:o({},H.content,s)},b,{dragConstraints:g,onMeasureDragConstraints:v}),a)})),B=["children","style","disableDrag"],Y=e.forwardRef((function(t,r){var a=t.children,s=t.style,c=t.disableDrag,l=i(t,B),u=w(),d=u.indicatorRotation,f=u.dragProps,p=y(),h=p.constraintsRef,g=p.onMeasureDragConstraints,v=c?void 0:f,b=n.useTransform(d,(function(e){return"translateX(2px) rotate("+e+"deg)"})),E=n.useTransform(d,(function(e){return"translateX(-2px) rotate("+-1*e+"deg)"}));return e.createElement(n.motion.div,Object.assign({},l,{ref:m([r,h]),style:o({},H.headerWrapper,s)},v,{dragConstraints:h,onMeasureDragConstraints:g}),a||e.createElement("div",{className:"react-modal-sheet-header",style:H.header},e.createElement(n.motion.span,{className:"react-modal-sheet-drag-indicator",style:o({},H.indicator,{transform:b})}),e.createElement(n.motion.span,{className:"react-modal-sheet-drag-indicator",style:o({},H.indicator,{transform:E})})))})),z=["style","className"],W=function(e){return!!e.onClick||!!e.onTap},V=e.forwardRef((function(t,r){var a=t.style,s=void 0===a?{}:a,c=t.className,l=void 0===c?"":c,u=i(t,z),d=W(u)?n.motion.button:n.motion.div,f=W(u)?"auto":"none";return e.createElement(d,Object.assign({},u,{ref:r,className:"react-modal-sheet-backdrop "+l,style:o({},H.backdrop,s,{pointerEvents:f}),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}))})),F=["draggableAt","children","style","className"],X=e.forwardRef((function(t,n){var r=t.draggableAt,a=void 0===r?"top":r,s=t.children,c=t.style,l=t.className,u=void 0===l?"":l,d=i(t,F),f=S();function m(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;if(n>r){var o=t<=0,i=n-t===r;"top"===a&&o||"bottom"===a&&i||"both"===a&&(o||i)?f.setDragEnabled():f.setDragDisabled()}}var p="undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0)?{onScroll:function(e){m(e.currentTarget)},onTouchStart:function(e){m(e.currentTarget)}}:void 0;return e.createElement("div",Object.assign({},d,{ref:n,className:"react-modal-sheet-scroller "+u,style:o({},H.scroller,c)},p),s)})),_=N;_.Container=A,_.Header=Y,_.Content=I,_.Backdrop=V,_.Scroller=X,exports.default=_;
//# sourceMappingURL=react-modal-sheet.cjs.production.min.js.map
